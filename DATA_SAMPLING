--DATA SAMPLING

CREATE OR REPLACE TRANSIENT DATABASE SAMPLING_DB;

CREATE OR REPLACE VIEW ADDRESS_SAMPLE
AS 
SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
SAMPLE ROW (1) SEED(27);

SELECT * FROM ADDRESS_SAMPLE;



SELECT CA_LOCATION_TYPE, COUNT(*)/3254250*100
FROM ADDRESS_SAMPLE
GROUP BY CA_LOCATION_TYPE;



SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
SAMPLE SYSTEM (1) SEED(23);

SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS 
SAMPLE SYSTEM (10) SEED(23);


----eXCERCISE
CREATE OR REPLACE TABLE DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE_5
AS
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."CUSTOMER_ADDRESS"
SAMPLE ROW(5) SEED(2);


--"SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."CUSTOMER_ADDRESS"
--Use the ROW method and seed(2) to get a reproducible result.
--Store the result in the DEMO_DB in a table called CUSTOMER_ADDRESS_SAMPLE_5.

SELECT * FROM CUSTOMER_ADDRESS_SAMPLE_5;

CREATE OR REPLACE TABLE DEMO_DB.PUBLIC.CUSTOMER_ADDRESS_SAMPLE_1
AS
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."CUSTOMER_ADDRESS"
SAMPLE SYSTEM(1) SEED(2);

SELECT * FROM CUSTOMER_ADDRESS_SAMPLE_1;
